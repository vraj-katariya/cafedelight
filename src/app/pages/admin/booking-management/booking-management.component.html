<div class="user-management">
    <div class="admin-header">
        <h1>Booking <span class="highlight">Management</span></h1>
        <div class="admin-nav">
            <a routerLink="/admin" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">Overview</a>
            <a routerLink="/admin/users" routerLinkActive="active">Users</a>
            <a routerLink="/admin/menu" routerLinkActive="active">Menu</a>
            <a routerLink="/admin/tables" routerLinkActive="active">Tables</a>
            <a routerLink="/admin/bookings" routerLinkActive="active">Bookings</a>
        </div>
    </div>

    <div class="dashboard-stats">
        <div class="stat-card">
            <span class="stat-value">{{ stats.total }}</span>
            <span class="stat-label">Total Bookings</span>
        </div>
        <div class="stat-card pending">
            <span class="stat-value">{{ stats.pending }}</span>
            <span class="stat-label">Pending</span>
        </div>
        <div class="stat-card confirmed">
            <span class="stat-value">{{ stats.confirmed }}</span>
            <span class="stat-label">Confirmed</span>
        </div>
        <div class="stat-card cancelled">
            <span class="stat-value">{{ stats.cancelled }}</span>
            <span class="stat-label">Cancelled</span>
        </div>
    </div>

    <div class="management-card">
        <div class="filters-bar">
            <div class="filter-group">
                <label>Filter by Date:</label>
                <input type="date" [(ngModel)]="filterDate" (change)="applyFilters()" class="filter-input">
            </div>
            <div class="filter-group">
                <label>Status:</label>
                <select [(ngModel)]="filterStatus" (change)="applyFilters()" class="filter-input">
                    <option value="">All Statuses</option>
                    <option value="Pending">Pending</option>
                    <option value="Confirmed">Confirmed</option>
                    <option value="Cancelled">Cancelled</option>
                    <option value="Completed">Completed</option>
                </select>
            </div>
            <button class="btn-clear" (click)="clearFilters()" *ngIf="filterDate || filterStatus">
                Clear Filters
            </button>
        </div>

        <div *ngIf="filteredBookings.length > 0; else emptyState">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Date & Time</th>
                        <th>Table Info</th>
                        <th>Customer Details</th>
                        <th>Guests</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let booking of filteredBookings">
                        <td>
                            <strong>{{ booking.date | date:'mediumDate' }}</strong><br>
                            <small>{{ booking.timeSlot }}</small>
                        </td>
                        <td>
                            <strong>Table {{ booking.table?.tableNumber }}</strong><br>
                            <small>{{ booking.table?.location }}</small>
                        </td>
                        <td>
                            <strong>{{ booking.user?.name || 'Guest' }}</strong><br>
                            <small>{{ booking.user?.email }}</small>
                        </td>
                        <td>{{ booking.guests }} Pax</td>
                        <td>
                            <span class="status-badge" [class]="'status-' + booking.status.toLowerCase()">
                                {{ booking.status }}
                            </span>
                        </td>
                        <td>
                            <button *ngIf="booking.status === 'Pending'" class="btn-action btn-confirm"
                                (click)="confirmBooking(booking._id!)">
                                Approve
                            </button>
                            <button *ngIf="booking.status !== 'Cancelled' && booking.status !== 'Completed'"
                                class="btn-action btn-cancel" (click)="cancelBooking(booking._id!)">
                                Cancel
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <ng-template #emptyState>
            <div class="empty-state">
                <span class="empty-icon">ðŸ“…</span>
                <h3>No Bookings Found</h3>
                <p>Current list of table reservations will appear here.</p>
            </div>
        </ng-template>
    </div>
</div>