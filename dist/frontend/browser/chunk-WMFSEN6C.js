import{a as G}from"./chunk-NDU335UD.js";import{a as U}from"./chunk-SF5532BX.js";import{b as R,d as B,f as A,i as N,r as q}from"./chunk-UFBRTC2V.js";import{b as L,d as W,e as j,h as F}from"./chunk-5EQP7JGP.js";import{Da as E,Oa as g,Pa as _,Pb as V,Ra as P,Sa as h,Sb as I,T as m,Ta as v,U as p,Ua as t,Ub as z,Va as n,Wa as w,_a as O,ab as u,cb as s,ib as D,kb as o,lb as C,mb as f,nb as T,ob as y,pb as b,qa as d,qb as M,ub as S,vb as k,ya as x}from"./chunk-IDMXUBOL.js";var H=(r,i)=>i._id,J=(r,i)=>i.menuItem;function K(r,i){r&1&&(t(0,"div",2),w(1,"div",6),t(2,"p"),o(3,"Loading orders..."),n()())}function Q(r,i){r&1&&(t(0,"div",3)(1,"span",7),o(2,"\u{1F4E6}"),n(),t(3,"h3"),o(4,"No orders yet"),n(),t(5,"p"),o(6,"You haven't placed any orders. Start ordering now!"),n(),t(7,"a",8),o(8,"Browse Menu"),n()())}function X(r,i){if(r&1&&(t(0,"div",16)(1,"span",27),o(2),n(),t(3,"span",28),o(4),n()()),r&2){let e=i.$implicit,c=s(3);d(2),T("",e.name," \xD7 ",e.quantity),d(2),C(c.formatPrice(e.price*e.quantity))}}function Z(r,i){if(r&1){let e=O();t(0,"button",29),u("click",function(){m(e);let a=s().$implicit,l=s(2);return p(l.openPaymentModal(a))}),o(1,"Pay Now"),n()}}function $(r,i){if(r&1){let e=O();t(0,"button",30),u("click",function(){m(e);let a=s().$implicit,l=s(2);return p(l.cancelOrder(a._id))}),o(1,"Cancel"),n()}}function ee(r,i){if(r&1&&(t(0,"div",9)(1,"div",10)(2,"div",11)(3,"span",12),o(4,"Order ID"),n(),t(5,"span",13),o(6),n()(),t(7,"div",14),o(8),n()(),t(9,"div",15),P(10,X,5,3,"div",16,J),n(),t(12,"div",17)(13,"div",18)(14,"span"),o(15,"Subtotal"),n(),t(16,"span"),o(17),n()(),t(18,"div",18)(19,"span"),o(20),n(),t(21,"span"),o(22),n()(),t(23,"div",19)(24,"span"),o(25,"Total"),n(),t(26,"span"),o(27),n()()(),t(28,"div",20)(29,"div",21)(30,"span",22),o(31),S(32,"titlecase"),n(),t(33,"span",23),o(34),S(35,"titlecase"),n()(),t(36,"div",24),g(37,Z,2,0,"button",25),g(38,$,2,0,"button",26),n()()()),r&2){let e=i.$implicit,c=s(2);d(6),C(e._id.slice(-8).toUpperCase()),d(2),f(" ",c.formatDate(e.createdAt)," "),d(2),h(e.items),d(7),C(c.formatPrice(e.subtotal)),d(3),f("GST (",e.gstRate,"%)"),d(2),C(c.formatPrice(e.gstAmount)),d(5),C(c.formatPrice(e.total)),d(3),v("ngClass",c.getStatusClass(e.status)),d(),f(" ",k(32,13,e.status)," "),d(2),D("paid",e.paymentStatus==="paid"),d(),f(" ",k(35,15,e.paymentStatus)," "),d(3),_(e.paymentStatus==="pending"&&e.status!=="cancelled"?37:-1),d(),_(e.status==="pending"?38:-1)}}function te(r,i){if(r&1&&(t(0,"div",4),P(1,ee,39,17,"div",9,H),n()),r&2){let e=s();d(),h(e.orders)}}function ne(r,i){r&1&&(w(0,"span",48),o(1," Processing... "))}function ie(r,i){if(r&1&&o(0),r&2){let e=s(2);f(" Pay ",e.formatPrice(e.selectedOrder.total)," ")}}function oe(r,i){if(r&1){let e=O();t(0,"div",31),u("click",function(){m(e);let a=s();return p(a.closePaymentModal())}),t(1,"div",32),u("click",function(a){return m(e),p(a.stopPropagation())}),t(2,"div",33)(3,"h2"),o(4,"Complete Payment"),n(),t(5,"button",34),u("click",function(){m(e);let a=s();return p(a.closePaymentModal())}),o(6,"\u2715"),n()(),t(7,"div",35)(8,"div",36)(9,"span",12),o(10,"Amount to Pay"),n(),t(11,"span",37),o(12),n()(),t(13,"div",38)(14,"label",39)(15,"input",40),M("ngModelChange",function(a){m(e);let l=s();return b(l.paymentMethod,a)||(l.paymentMethod=a),p(a)}),n(),t(16,"span",41)(17,"span",42),o(18,"\u{1F4F1}"),n(),t(19,"span",43),o(20,"UPI"),n()()(),t(21,"label",39)(22,"input",44),M("ngModelChange",function(a){m(e);let l=s();return b(l.paymentMethod,a)||(l.paymentMethod=a),p(a)}),n(),t(23,"span",41)(24,"span",42),o(25,"\u{1F4B3}"),n(),t(26,"span",43),o(27,"Card"),n()()(),t(28,"label",39)(29,"input",45),M("ngModelChange",function(a){m(e);let l=s();return b(l.paymentMethod,a)||(l.paymentMethod=a),p(a)}),n(),t(30,"span",41)(31,"span",42),o(32,"\u{1F4B5}"),n(),t(33,"span",43),o(34,"Cash"),n()()(),t(35,"label",39)(36,"input",46),M("ngModelChange",function(a){m(e);let l=s();return b(l.paymentMethod,a)||(l.paymentMethod=a),p(a)}),n(),t(37,"span",41)(38,"span",42),o(39,"\u{1F45B}"),n(),t(40,"span",43),o(41,"Wallet"),n()()()(),t(42,"button",47),u("click",function(){m(e);let a=s();return p(a.processPayment())}),g(43,ne,2,0)(44,ie,1,1),n()()()()}if(r&2){let e=s();d(12),C(e.formatPrice(e.selectedOrder.total)),d(3),y("ngModel",e.paymentMethod),d(7),y("ngModel",e.paymentMethod),d(7),y("ngModel",e.paymentMethod),d(7),y("ngModel",e.paymentMethod),d(6),v("disabled",!e.paymentMethod||e.isProcessingPayment),d(),_(e.isProcessingPayment?43:44)}}var Y=class r{constructor(i,e,c,a){this.orderService=i;this.paymentService=e;this.route=c;this.router=a}orders=[];selectedOrder=null;isLoading=!0;isProcessingPayment=!1;showPaymentModal=!1;paymentMethod="";ngOnInit(){this.loadOrders(),this.route.params.subscribe(i=>{i.id&&this.loadOrderDetails(i.id)})}loadOrders(){this.isLoading=!0,this.orderService.getOrders().subscribe({next:i=>{i.success&&i.orders&&(this.orders=i.orders),this.isLoading=!1},error:()=>{this.isLoading=!1}})}loadOrderDetails(i){this.orderService.getOrder(i).subscribe({next:e=>{e.success&&e.order&&(this.selectedOrder=e.order,this.showPaymentModal=e.order.paymentStatus==="pending")}})}openPaymentModal(i){this.selectedOrder=i,this.showPaymentModal=!0}closePaymentModal(){this.showPaymentModal=!1,this.paymentMethod=""}processPayment(){!this.selectedOrder||!this.paymentMethod||(this.isProcessingPayment=!0,this.paymentService.createPayment(this.selectedOrder._id,this.paymentMethod).subscribe({next:i=>{i.success&&(this.loadOrders(),this.closePaymentModal(),alert("Payment successful!")),this.isProcessingPayment=!1},error:()=>{this.isProcessingPayment=!1,alert("Payment failed. Please try again.")}}))}cancelOrder(i){confirm("Are you sure you want to cancel this order?")&&this.orderService.cancelOrder(i).subscribe({next:()=>{this.loadOrders()},error:()=>{alert("Failed to cancel order")}})}getStatusClass(i){return{pending:"status-pending",confirmed:"status-confirmed",preparing:"status-preparing",ready:"status-ready",delivered:"status-delivered",cancelled:"status-cancelled"}[i]||""}formatPrice(i){return"\u20B9"+i.toFixed(2)}formatDate(i){return new Date(i).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}static \u0275fac=function(e){return new(e||r)(x(U),x(G),x(L),x(W))};static \u0275cmp=E({type:r,selectors:[["app-orders"]],decls:9,vars:4,consts:[[1,"orders-page"],[1,"highlight"],[1,"loading"],[1,"empty-state"],[1,"orders-list"],[1,"modal-overlay"],[1,"spinner-large"],[1,"empty-icon"],["routerLink","/menu",1,"btn-browse"],[1,"order-card"],[1,"order-header"],[1,"order-id"],[1,"label"],[1,"value"],[1,"order-date"],[1,"order-items"],[1,"order-item"],[1,"order-summary"],[1,"summary-row"],[1,"summary-row","total"],[1,"order-footer"],[1,"status-badges"],[1,"status-badge",3,"ngClass"],[1,"payment-badge"],[1,"order-actions"],[1,"btn-pay"],[1,"btn-cancel"],[1,"item-name"],[1,"item-price"],[1,"btn-pay",3,"click"],[1,"btn-cancel",3,"click"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"modal-body"],[1,"payment-amount"],[1,"amount"],[1,"payment-methods"],[1,"payment-option"],["type","radio","name","payment","value","upi",3,"ngModelChange","ngModel"],[1,"option-content"],[1,"icon"],[1,"text"],["type","radio","name","payment","value","card",3,"ngModelChange","ngModel"],["type","radio","name","payment","value","cash",3,"ngModelChange","ngModel"],["type","radio","name","payment","value","wallet",3,"ngModelChange","ngModel"],[1,"btn-process-payment",3,"click","disabled"],[1,"spinner"]],template:function(e,c){e&1&&(t(0,"div",0)(1,"h1"),o(2,"My "),t(3,"span",1),o(4,"Orders"),n()(),g(5,K,4,0,"div",2),g(6,Q,9,0,"div",3),g(7,te,3,0,"div",4),g(8,oe,45,7,"div",5),n()),e&2&&(d(5),_(c.isLoading?5:-1),d(),_(!c.isLoading&&c.orders.length===0?6:-1),d(),_(!c.isLoading&&c.orders.length>0?7:-1),d(),_(c.showPaymentModal&&c.selectedOrder?8:-1))},dependencies:[z,V,F,j,q,R,N,B,A,I],styles:[".orders-page[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;padding:2rem}.orders-page[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;color:#fff;margin-bottom:2rem}.highlight[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f39c12,#e74c3c);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.loading[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem}.spinner-large[_ngcontent-%COMP%]{width:50px;height:50px;border:3px solid rgba(255,255,255,.1);border-top-color:#f39c12;border-radius:50%;margin:0 auto 1rem;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.empty-icon[_ngcontent-%COMP%]{font-size:5rem;display:block;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff;font-size:1.5rem;margin-bottom:.5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#888;margin-bottom:2rem}.btn-browse[_ngcontent-%COMP%]{display:inline-block;padding:1rem 2rem;background:linear-gradient(135deg,#f39c12,#e74c3c);color:#fff;text-decoration:none;border-radius:12px;font-weight:600}.orders-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.order-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1a1a2e,#16213e);border-radius:20px;padding:1.5rem;border:1px solid rgba(255,255,255,.1)}.order-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;padding-bottom:1rem;border-bottom:1px solid rgba(255,255,255,.1)}.order-id[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:block;color:#888;font-size:.85rem}.order-id[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#f39c12;font-weight:700;font-size:1.1rem}.order-date[_ngcontent-%COMP%]{color:#888;font-size:.9rem}.order-items[_ngcontent-%COMP%]{margin-bottom:1rem}.order-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem 0;color:#ccc}.item-name[_ngcontent-%COMP%]{color:#fff}.order-summary[_ngcontent-%COMP%]{padding-top:1rem;border-top:1px solid rgba(255,255,255,.1)}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.25rem 0;color:#888;font-size:.9rem}.summary-row.total[_ngcontent-%COMP%]{color:#fff;font-weight:700;font-size:1.1rem;margin-top:.5rem}.order-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:1rem;padding-top:1rem;border-top:1px solid rgba(255,255,255,.1)}.status-badges[_ngcontent-%COMP%]{display:flex;gap:.5rem}.status-badge[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:20px;font-size:.85rem;font-weight:500}.status-pending[_ngcontent-%COMP%]{background:#f1c40f33;color:#f1c40f}.status-confirmed[_ngcontent-%COMP%]{background:#3498db33;color:#3498db}.status-preparing[_ngcontent-%COMP%]{background:#9b59b633;color:#9b59b6}.status-ready[_ngcontent-%COMP%], .status-delivered[_ngcontent-%COMP%]{background:#2ecc7133;color:#2ecc71}.status-cancelled[_ngcontent-%COMP%]{background:#e74c3c33;color:#e74c3c}.payment-badge[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:20px;font-size:.85rem;background:#e74c3c33;color:#e74c3c}.payment-badge.paid[_ngcontent-%COMP%]{background:#2ecc7133;color:#2ecc71}.order-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.btn-pay[_ngcontent-%COMP%]{padding:.5rem 1.5rem;background:linear-gradient(135deg,#f39c12,#e74c3c);border:none;border-radius:8px;color:#fff;font-weight:500;cursor:pointer}.btn-cancel[_ngcontent-%COMP%]{padding:.5rem 1rem;background:transparent;border:1px solid #e74c3c;border-radius:8px;color:#e74c3c;cursor:pointer}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000c;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.modal-content[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1a1a2e,#16213e);border-radius:20px;width:100%;max-width:400px;border:1px solid rgba(255,255,255,.1)}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem;border-bottom:1px solid rgba(255,255,255,.1)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;font-size:1.3rem}.close-btn[_ngcontent-%COMP%]{background:transparent;border:none;color:#888;font-size:1.5rem;cursor:pointer}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.payment-amount[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem}.payment-amount[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:block;color:#888;margin-bottom:.5rem}.payment-amount[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#f39c12}.payment-methods[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1.5rem}.payment-option[_ngcontent-%COMP%]{cursor:pointer}.payment-option[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.option-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:1rem;background:#ffffff0d;border:2px solid rgba(255,255,255,.1);border-radius:12px;transition:all .3s ease}.payment-option[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .option-content[_ngcontent-%COMP%]{border-color:#f39c12;background:#f39c121a}.option-content[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:2rem;margin-bottom:.5rem}.option-content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:#fff;font-weight:500}.btn-process-payment[_ngcontent-%COMP%]{width:100%;padding:1rem;background:linear-gradient(135deg,#f39c12,#e74c3c);border:none;border-radius:12px;color:#fff;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:.5rem}.btn-process-payment[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.spinner[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@media(max-width:768px){.orders-page[_ngcontent-%COMP%]{padding:1rem}.orders-page[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem}.order-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.5rem}.order-footer[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:1rem}.status-badges[_ngcontent-%COMP%]{justify-content:space-between}}@media(max-width:480px){.order-card[_ngcontent-%COMP%]{padding:1rem}.status-badge[_ngcontent-%COMP%], .payment-badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.4rem .75rem}.order-actions[_ngcontent-%COMP%]{flex-direction:column}.btn-pay[_ngcontent-%COMP%], .btn-cancel[_ngcontent-%COMP%]{width:100%;text-align:center}}"]})};export{Y as OrdersComponent};
