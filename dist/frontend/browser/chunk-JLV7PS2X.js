import{F as o,J as i,N as n,_b as a,bc as u,h as s}from"./chunk-IDMXUBOL.js";var l=class r{constructor(t){this.http=t;this.loadUserFromStorage()}apiUrl=`${u.apiUrl}/auth`;currentUserSubject=new s(null);currentUser$=this.currentUserSubject.asObservable();hasBookingSubject=new s(!1);hasBooking$=this.hasBookingSubject.asObservable();loadUserFromStorage(){let t=localStorage.getItem("token"),e=localStorage.getItem("user");t&&e&&this.currentUserSubject.next(JSON.parse(e))}get currentUserValue(){return this.currentUserSubject.value}get isLoggedIn(){return!!this.currentUserSubject.value}get isAdmin(){return this.currentUserSubject.value?.role==="admin"}get token(){return localStorage.getItem("token")}setHasBooking(t){this.hasBookingSubject.next(t)}get hasBooking(){return this.hasBookingSubject.value}register(t){return this.http.post(`${this.apiUrl}/register`,t).pipe(o(e=>{e.success&&e.token&&e.user&&this.setSession(e.token,e.user)}))}login(t){return this.http.post(`${this.apiUrl}/login`,t).pipe(o(e=>{e.success&&e.token&&e.user&&this.setSession(e.token,e.user)}))}getProfile(){return this.http.get(`${this.apiUrl}/me`)}setSession(t,e){localStorage.setItem("token",t),localStorage.setItem("user",JSON.stringify(e)),this.currentUserSubject.next(e)}logout(){localStorage.removeItem("token"),localStorage.removeItem("user"),this.currentUserSubject.next(null)}updateCurrentUser(t){localStorage.setItem("user",JSON.stringify(t)),this.currentUserSubject.next(t)}static \u0275fac=function(e){return new(e||r)(n(a))};static \u0275prov=i({token:r,factory:r.\u0275fac,providedIn:"root"})};export{l as a};
