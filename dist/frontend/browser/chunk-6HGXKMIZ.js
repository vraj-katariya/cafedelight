import{a as Q}from"./chunk-2Q7OKKZN.js";import{a as N}from"./chunk-VVO5EFFG.js";import{a as F}from"./chunk-JLV7PS2X.js";import{b as D,c as b,d as V,e as A,g as z,h as G,j,k as R,l as q,m as H,n as Y,o as $,p as J,q as K,s as L}from"./chunk-UFBRTC2V.js";import{d as B}from"./chunk-5EQP7JGP.js";import{Da as M,Ha as m,Qb as I,Rb as w,T as _,Ta as c,U as v,Ua as o,Ub as E,Va as n,Wa as C,_a as x,a as T,ab as h,b as O,cb as d,gb as P,ib as k,kb as r,lb as S,mb as f,qa as a,xb as y,ya as g}from"./chunk-IDMXUBOL.js";function W(t,i){if(t&1&&(o(0,"div",13),r(1),n()),t&2){let e=d();k("alert-danger",!0),a(),f(" ",e.message," ")}}function X(t,i){if(t&1&&(o(0,"option",14),r(1),n()),t&2){let e=i.$implicit;c("value",e),a(),S(e)}}function Z(t,i){if(t&1){let e=x();o(0,"div",19),h("click",function(){let s=_(e).$implicit,u=d(2);return v(u.selectTable(s))}),o(1,"span",20),r(2),n(),o(3,"span",21),r(4,"\u{1FA91}"),n(),o(5,"div",22)(6,"h4"),r(7),n(),o(8,"p"),r(9),n()()()}if(t&2){let e=i.$implicit,l=d(2);k("selected",(l.selectedTable==null?null:l.selectedTable._id)===e._id),a(2),S(e.location),a(5),f("Table ",e.tableNumber),a(2),f("Capacity: ",e.capacity," People")}}function ee(t,i){if(t&1){let e=x();o(0,"div",23)(1,"button",24),h("click",function(){_(e);let s=d(2);return v(s.confirmBooking())}),r(2," Confirm Reservation \u2794 "),n()()}}function te(t,i){if(t&1&&(o(0,"div",15)(1,"h3"),r(2,"Available Tables for Selected Slot"),n(),o(3,"div",16),m(4,Z,10,5,"div",17),n(),m(5,ee,3,0,"div",18),n()),t&2){let e=d();a(4),c("ngForOf",e.availableTables),a(),c("ngIf",e.selectedTable)}}function ne(t,i){t&1&&(o(0,"span"),r(1,"System Error: No tables have been setup by the Admin yet."),n())}function ie(t,i){t&1&&(o(0,"span"),r(1,"No tables available for this date and time. Please try a different slot."),n())}function oe(t,i){if(t&1&&(o(0,"div",27),m(1,ne,2,0,"span",28)(2,ie,2,0,"span",28),n()),t&2){let e=d(2);a(),c("ngIf",e.totalTablesCount===0),a(),c("ngIf",e.totalTablesCount>0)}}function re(t,i){t&1&&(o(0,"div",29),r(1," Searching for best tables... "),n())}function ae(t,i){if(t&1&&m(0,oe,3,2,"div",25)(1,re,2,0,"div",26),t&2){let e=d();c("ngIf",!e.loading&&e.searched&&e.availableTables.length===0),a(),c("ngIf",e.loading)}}var U=class t{constructor(i,e,l,s,u){this.fb=i;this.bookingService=e;this.authService=l;this.tableService=s;this.router=u;this.bookingForm=this.fb.group({date:["",b.required],timeSlot:["",b.required],guests:[2,[b.required,b.min(1)]],notes:[""]}),this.checkInitialTables()}bookingForm;availableTables=[];selectedTable=null;timeSlots=["10:00-11:00","11:00-12:00","12:00-13:00","13:00-14:00","18:00-19:00","19:00-20:00","20:00-21:00"];minDate=new Date().toISOString().split("T")[0];loading=!1;searched=!1;totalTablesCount=0;message="";checkInitialTables(){this.tableService.getTables().subscribe(i=>{this.totalTablesCount=i.data.length})}checkAvailability(){if(this.bookingForm.invalid)return;let{date:i,timeSlot:e,guests:l}=this.bookingForm.value,s=new Date;if(new Date(i).toDateString()===s.toDateString()){let p=parseInt(e.split(":")[0]);if(s.getHours()>=p){this.message="Selected time slot has already passed for today.";return}}this.loading=!0,this.searched=!0,this.message="",this.bookingService.checkAvailability(i,e).subscribe({next:p=>{this.availableTables=p.data,this.loading=!1,this.selectedTable=null,this.availableTables.length===0&&(this.message="No tables available for "+l+" guests at this time.")},error:p=>{this.message=p.error.message||"Error checking availability",this.loading=!1}})}selectTable(i){this.selectedTable=i}confirmBooking(){if(!this.selectedTable)return;let i=O(T({},this.bookingForm.value),{table:this.selectedTable._id});this.bookingService.createBooking(i).subscribe({next:e=>{alert("Booking Confirmed!"),this.authService.setHasBooking(!0),this.router.navigate(["/menu"])},error:e=>{this.message=e.error.message||"Booking Failed"}})}static \u0275fac=function(e){return new(e||t)(g(K),g(N),g(F),g(Q),g(B))};static \u0275cmp=M({type:t,selectors:[["app-booking"]],decls:27,vars:8,consts:[["noTables",""],[1,"booking-container","fade-in"],[1,"page-title"],["class","alert",3,"alert-danger",4,"ngIf"],[1,"booking-form",3,"ngSubmit","formGroup"],[1,"form-group"],["type","date","formControlName","date",1,"form-control",3,"min"],["formControlName","timeSlot",1,"form-control"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["type","number","formControlName","guests","min","1","max","20","placeholder","e.g. 2",1,"form-control"],["type","submit",1,"btn-check",3,"disabled"],["class","tables-section",4,"ngIf","ngIfElse"],[1,"alert"],[3,"value"],[1,"tables-section"],[1,"tables-grid"],["class","table-card",3,"selected","click",4,"ngFor","ngForOf"],["class","action-area",4,"ngIf"],[1,"table-card",3,"click"],[1,"table-badge"],[1,"table-icon"],[1,"table-info"],[1,"action-area"],[1,"btn-confirm",3,"click"],["class","alert alert-danger",4,"ngIf"],["class","loading-spinner",4,"ngIf"],[1,"alert","alert-danger"],[4,"ngIf"],[1,"loading-spinner"]],template:function(e,l){if(e&1){let s=x();o(0,"div",1)(1,"h2",2),r(2,"Book the "),o(3,"span"),r(4,"Table"),n()(),m(5,W,2,3,"div",3),o(6,"form",4),h("ngSubmit",function(){return _(s),v(l.checkAvailability())}),o(7,"div",5)(8,"label"),r(9,"Select Date"),n(),C(10,"input",6),n(),o(11,"div",5)(12,"label"),r(13,"Time Slot"),n(),o(14,"select",7)(15,"option",8),r(16,"Choose a time..."),n(),m(17,X,2,2,"option",9),n()(),o(18,"div",5)(19,"label"),r(20,"Number of Guests"),n(),C(21,"input",10),n(),o(22,"button",11),r(23),n()(),m(24,te,6,2,"div",12)(25,ae,2,2,"ng-template",null,0,y),n()}if(e&2){let s=P(26);a(5),c("ngIf",l.message),a(),c("formGroup",l.bookingForm),a(4),c("min",l.minDate),a(7),c("ngForOf",l.timeSlots),a(5),c("disabled",l.bookingForm.invalid||l.loading),a(),f(" ",l.loading?"Checking...":"Check Availability"," "),a(),c("ngIf",l.availableTables.length>0)("ngIfElse",s)}},dependencies:[E,I,w,L,z,H,Y,D,G,q,V,A,J,$,R,j],styles:[".booking-container[_ngcontent-%COMP%]{max-width:1000px;margin:3rem auto;padding:2rem}.page-title[_ngcontent-%COMP%]{text-align:center;font-size:2.5rem;font-weight:700;color:#fff;margin-bottom:2rem}.page-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f39c12,#e74c3c);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.booking-form[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1.5rem;justify-content:center;background:linear-gradient(135deg,#1a1a2e,#16213e);padding:2rem;border-radius:16px;margin-bottom:3rem;border:1px solid rgba(255,255,255,.1)}.form-group[_ngcontent-%COMP%]{flex:1 1 200px;display:flex;flex-direction:column}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.5rem;color:#aaa;font-size:.9rem}.form-control[_ngcontent-%COMP%]{padding:.8rem;background:#ffffff0d;border:1px solid rgba(255,255,255,.1);border-radius:8px;color:#fff;font-size:1rem;transition:all .3s ease}.form-control[_ngcontent-%COMP%]:focus{border-color:#f39c12;outline:none}.btn-check[_ngcontent-%COMP%]{padding:.8rem 2rem;background:linear-gradient(135deg,#f39c12,#e74c3c);color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:background .3s;margin-top:auto;height:48px}.btn-check[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px)}.btn-check[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.tables-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;color:#fff;margin-bottom:1.5rem}.tables-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:1.5rem}.table-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1a1a2e,#16213e);border:1px solid rgba(255,255,255,.1);border-radius:16px;padding:1.5rem;text-align:center;cursor:pointer;transition:all .3s ease;position:relative;overflow:hidden}.table-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);border-color:#f39c12}.table-card.selected[_ngcontent-%COMP%]{background:#f39c121a;border-color:#f39c12;box-shadow:0 8px 20px #f39c1233}.table-icon[_ngcontent-%COMP%]{font-size:2.5rem;margin-bottom:1rem;display:block}.table-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#fff;font-size:1.2rem}.table-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0 0;color:#888;font-size:.9rem}.table-badge[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background:#27ae60;color:#fff;padding:2px 8px;border-radius:10px;font-size:.7rem;text-transform:uppercase;font-weight:700}.action-area[_ngcontent-%COMP%]{margin-top:2rem;text-align:center}.btn-confirm[_ngcontent-%COMP%]{padding:1rem 3rem;background:linear-gradient(135deg,#f39c12,#e74c3c);color:#fff;border:none;border-radius:50px;font-size:1.1rem;font-weight:600;cursor:pointer;transition:all .3s ease}.btn-confirm[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 20px #f39c1266}@media(max-width:768px){.booking-container[_ngcontent-%COMP%]{padding:1rem;margin:1rem auto}.page-title[_ngcontent-%COMP%]{font-size:1.8rem}.booking-form[_ngcontent-%COMP%]{padding:1rem}.form-group[_ngcontent-%COMP%]{flex:1 1 100%}}@media(max-width:480px){.tables-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.btn-confirm[_ngcontent-%COMP%]{width:100%;padding:1rem}}.alert[_ngcontent-%COMP%]{padding:1rem;border-radius:8px;margin-bottom:1rem;text-align:center}.alert-danger[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b;border:1px solid #fecaca}.loading-spinner[_ngcontent-%COMP%]{text-align:center;color:#666;font-style:italic;margin:2rem 0}"]})};export{U as BookingComponent};
